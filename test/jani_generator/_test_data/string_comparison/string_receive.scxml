<?xml version="1.0" encoding="UTF-8"?>
<scxml
    name="string_receive"
    version="1.0"
    initial="init"
    model_src=""
    xmlns="http://www.w3.org/2005/07/scxml">

    <datamodel>
        <data id="string_store" expr="''" type="string" />
        <data id="comparison" expr="false" type="bool" />
    </datamodel>

    <state id="init">
        <transition target="init" event="string_event" cond="_event.data.string == 'more information'">
            <assign location="string_store" expr="_event.data.string" />
            <send event="comp_result">
                <param name="res" expr="1" />
            </send>
            <send event="string_eval">
                <param name="comparison" expr="string_store == 'some information'" />
            </send>
        </transition>
        <transition target="init" event="string_event">
            <assign location="string_store" expr="_event.data.string" />
            <assign location="comparison" expr="string_store == 'some information'" />
            <if cond="comparison">
                <send event="comp_result">
                    <param name="res" expr="2" />
                </send>
                <else/>
                <send event="comp_result">
                    <param name="res" expr="-1" />
                </send>
            </if>
            <send event="string_eval">
                <param name="comparison" expr="string_store == 'some information'" />
            </send>
        </transition>
        <onexit>
            <!--
            The send-event should be here, not in the transitions above.
            However, due to a bug, that gets executed only after a new event in the state is received...
             -->
            <!-- <send event="string_eval">
                <param name="comparison" expr="string_store == 'some information'" />
            </send> -->
        </onexit>
    </state>
</scxml>
